{% extends "user.html" %}

{% block title %}
    {{post.title}}
{% endblock title %}

{% block content %}
    <div class="container">
        <a class="btn btn-primary" href="{% url "yaksh:course_forum" post.course.id %}">Back to Posts</a>
        <div class="card">
            <div class="card-header">
                {{post.title}}
                <br>
                <small>
                    <strong>{{post.creator.username}}</strong>
                    {{post.created_at}}
                    {% if user.profile.is_moderator %}<a href="{% url "yaksh:hide_post" post.course.id post.uid %}" class="pull-right">Delete</a>{% endif %}
                </small>

            </div>
            <div class="card-body">
                <p>{{post.description}}</p>
                {% if post.image %}
                    <a href="{{post.image.url}}" target="_blank">
                        <img src="{{post.image.url}}" class="img-fluid" alt="">
                    </a>
                {% endif %}
            </div>
        </div>
        <br>
        <div class="card">
            {% if comments %}
                <div class="card-header">Comments:</div>
                {% for comment in comments %}
                    <div class="card-body">
                        {% if comment.image %}
                            <a href="{{comment.image.url}}" target="_blank">
                                <img src="{{comment.image.url}}" class='img-fluid'>
                            </a>
                        {% endif %}
                        <p>{{comment.description}}</p>
                        <small class="pull-right">
                            by: <strong>{{comment.creator.username}} </strong>. {{comment.created_at}}
                            {% if user.profile.is_moderator %}<a href="{% url "yaksh:hide_comment" post.course.id comment.uid %}">Delete</a>{% endif %}
                        </small>
                    </div>
                    <hr>
                {% endfor %}
            {% else %}
                    No comments on this post.
            {% endif %}
        </div>
        <br>
        <div>
            <form action="{% url "yaksh:post_comments" post.course.id post.uid %}" method="POST" enctype='multipart/form-data'>
                <div class="form-group">
                    {% csrf_token %}
                    {{form}}
                </div>
                <input type="submit" value="Submit" class="btn btn-primary">
            </form>
        </div>
    </div>
{% endblock content %}